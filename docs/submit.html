<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ä½œå“æå‡ºãƒ•ã‚©ãƒ¼ãƒ </title>
  <style>
    body { font-family: "Yu Gothic", sans-serif; margin: 20px; }
    h1 { font-size: 1.5em; margin-bottom: 20px; }
    label { display: block; margin-top: 10px; }
    input, textarea, button { width: 100%; padding: 8px; margin-top: 5px; }
    .preview { margin-top: 20px; border: 1px solid #ccc; padding: 10px; }
    .instructions { background: #f9f9f9; padding: 10px; border-left: 4px solid #4CAF50; margin-top: 30px; }
  </style>
</head>
<body>
  <h1>ä½œå“æå‡ºãƒ•ã‚©ãƒ¼ãƒ </h1>

  <label>åå‰ï¼ˆä½œè€…åï¼‰</label>
  <input type="text" id="name" placeholder="ä¾‹ï¼šç”°ä¸­èŠ±å­">

  <label>ä½œå“ã‚¿ã‚¤ãƒˆãƒ«</label>
  <input type="text" id="title" placeholder="ä¾‹ï¼šç§‹ã®é¢¨">

  <label>ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆä»»æ„ï¼‰</label>
  <textarea id="comment" placeholder="ä½œå“ã¸ã®æ€ã„ã‚„å·¥å¤«ãªã©"></textarea>

  <label>ä½œå“ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJSONï¼‰</label>
  <input type="file" id="fileInput" accept=".json">

  <button onclick="submitWork()">ä½œå“ã‚’ç¢ºèªã™ã‚‹</button>

  <div class="preview" id="preview" style="display:none;"></div>

  <div class="instructions">
    <h3>ğŸ“® æå‡ºæ–¹æ³•</h3>
    <p>ã€ŒJSONå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ä½œå“ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦ãã ã•ã„ã€‚</p>
    <p>ä¿å­˜ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«åã¯ã€Œä½œå“ã‚¿ã‚¤ãƒˆãƒ«_ä½œè€…å.jsonã€ã®å½¢å¼ã«ãªã‚Šã¾ã™ï¼ˆè‹±æ•°å­—ã®ã¿ï¼‰ã€‚</p>
    <p>ä¿å­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§å…ˆç”Ÿã«æå‡ºã—ã¦ãã ã•ã„ï¼š</p>
    <ul>
      <li>å­¦æ ¡ã®å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
      <li>ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ï¼ˆä»¶åã«åå‰ã¨ä½œå“ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¨˜å…¥ï¼‰</li>
      <li>Googleãƒ•ã‚©ãƒ¼ãƒ ãŒã‚ã‚‹å ´åˆã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«æ·»ä»˜ã—ã¦æå‡º</li>
    </ul>
    <p>æå‡ºã•ã‚ŒãŸä½œå“ã¯ã€ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã«æ²è¼‰ã•ã‚Œã¾ã™âœ¨</p>
  </div>

  <script>
    function submitWork() {
      const name = document.getElementById("name").value.trim();
      const title = document.getElementById("title").value.trim();
      const comment = document.getElementById("comment").value.trim();
      const fileInput = document.getElementById("fileInput");
      const preview = document.getElementById("preview");

      if (!name || !title || fileInput.files.length === 0) {
        alert("åå‰ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ä½œå“ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¿…é ˆã§ã™");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          data.name = name;
          data.title = title;
          data.comment = comment;

          const jsonText = JSON.stringify(data, null, 2);
          preview.style.display = "block";
          preview.innerHTML = `
            <h3>æå‡ºå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
            <pre>${jsonText}</pre>
            <button onclick='downloadJSON("${generateSafeFilename(title, name)}", ${JSON.stringify(data)})'>JSONå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
          `;
        } catch (err) {
          alert("JSONãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ");
        }
      };
      reader.readAsText(fileInput.files[0]);
    }

    function generateSafeFilename(title, name) {
      const safeTitle = title.replace(/[^\w\-]/g, "_");
      const safeName = name.replace(/[^\w\-]/g, "_");
      return `${safeTitle}_${safeName}`;
    }

    function downloadJSON(filename, data) {
      const json = JSON.stringify(data, null, 2);
      const blob = new Blob([json], { type: "application/json" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = `${filename}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>

